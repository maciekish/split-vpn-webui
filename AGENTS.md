This project is currently a half-finished web-ui for https://github.com/peacey/split-vpn. It's designed to run on UniFi Dream Machine se (Debian based small business gateway).

Some things like statistics collection and display work, i want to keep those parts. VPN-control was never fully implemented.

I want the following things done:

1) Make this a standalone project without peacey/split-vpn dependency, but use peacey/split-vpn as a guide on how to make split VPN work.
2) Initial support only for Wireguard and OpenVPN. Other VPN types that peacey/split-vpn supports can be deferred to later.
3) It must be a full "webui" app without the user needing to edit files via ssh etc, every feature must fully work via the webui.
4) Add/edit/remove/start/stop/restart any managed VPN from the webui. Make sure all required fields for VPN config files are available in your webui. Wireguard should support the standard vpn-name.wg config files and OpenVPN should support the standard vpn-name.ovpn config files generated by their respective server software. For reference, you can find my current peacey/split-vpn running config in /Users/maciekish/Developer/Repositories/Appulize/unifi-split-vpn, there are sample wg0.conf and DreamMachine.ovpn files etc.
5) Full control of which domains are sent via VPN, like my old /Users/maciekish/Developer/Repositories/Appulize/unifi-split-vpn/on_boot.d/20-ipset.sh file but with full GUI. Support for "domain groups" just like in that file, so user can make groups and assign the groups to an egress VPN easily.
6) Full webui implementation of the pre-warm script in /Users/maciekish/Developer/Repositories/Appulize/unifi-split-vpn/on_boot.d/90-ipset-prewarm.sh. With control of how often it runs, how many domains it resolves in parallel etc. Also show live in ui the progress, last runtime of the pre-warm etc. Of course fully implemented in the webapp, the script is just the old implementation to serve as an example.
7) Don't lose any features from the current implementation or peacey/split-vpn, like auto-detect WAN interface with manual config fallback etc.
8) It must be nicely installable like other projects like "curl https://github.com/maciekish/split-vpn-webui/install.sh | bash" or similar. Properly reasearch how to do this on modern UniFi gateways, it should probably go into /data/split-vpn-webui or something. It should require and use https://github.com/unifi-utilities/unifios-utilities, ie assume the user has installed the persistence system from unifi-utilities/unifios-utilities and this app will be launched from there using /data/on_boot.d.

Implementation guidelines: I want as much as possible in the runtime to be done in this project, ie in code, without relying too much on bash scripts etc. With a few exceptions: I want VPN's to be actual systemd jobs like wg0-sgp.swic.name.service so they properly start and stop on reboots etc. This app should create the systemd unit and be able to start/stop/restart it of course, but the VPNs should "run" outside of this app so they dont crash if the VPN crashes etc. Make SURE you do NOT clash with UniFi's own VPN manager, research what names and queues etc it uses for its own VPNs so both can coexist peacefully.

Code quality: Its IMPERATIVE that you always strive for the highest code quality reasonably possible. Don't take shortcuts on big features that may paint you into a corner in the future. Keep everything modular and easily extensible with cleanky separated areas of responsibility of each component. No 500+ line files, refactor into separate files & modules to keep everything nice and tidy. Consider any and all edge cases reasonably possible. Make sure your code is bug-free and works on the first try. Implement as many tests as possible (if possible, they may not affect the host they run on), and run them continuosly during development to make sure any feature you implement has as many tests as it needs to ensure you can keep everything working when changes are made, so things dont break silently.